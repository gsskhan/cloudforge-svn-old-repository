
#query.cache.rules.enrichment=SELECT map.sys_proc_id AS PROC_UNIT_ID, attr.attr_nm  AS ruleAttribute, REPLACE(enrch_rule_to_exec, '{scheduleIdHolder}', map.sys_proc_id) AS ruleToExecute , e.enrch_rule_ord AS ruleOrder FROM TMP_RRC_ENRCH_RULE e, TMP_RRC_ENRCH_MAP map , TMP_RRC_ETL_ATTRIBUTE attr WHERE map.enrch_rule_id = e.enrch_rule_id AND map.attr_id=attr.attr_id  AND map.EFF_STS='A' ORDER BY ruleOrder

#query.cache.rules.enrichment.with.key=SELECT  DECODE(map.cat_cd , NULL,'',map.cat_cd  ||':')  || DECODE(map.sys_proc_id , NULL,'',map.sys_proc_id) AS KEY,  map.sys_proc_id AS sys_proc_id,  attr.attr_nm AS ruleAttribute,  REPLACE(REPLACE(enrch_rule_to_exec, '{scheduleIdHolder}', spd.sys_proc_id),  '{busFuncHolder}', Trim(pu.bus_func_cd)) AS ruleToExecute ,  e.enrch_rule_ord AS ruleorder FROM tmp_rrc_enrch_rule e, tmp_rrc_enrch_map map,  tmp_rrc_etl_attribute attr,  tmp_rrc_sys_proc_def spd,  rrr_proc_unit_da_tmp pu WHERE   map.enrch_rule_id =e.enrch_rule_id AND map.attr_id =attr.attr_id AND map.sys_proc_id =spd.sys_proc_id AND spd.proc_unit_id=pu.proc_unit_id AND map.eff_sts ='A' AND e.eff_sts ='A' ORDER BY  ruleorder

#query.cache.rules.aggregation=SELECT trim(oam.sys_proc_id) AS PROCESSING_UNIT_ID,oam.AGGR_RULE_ID,oar.AGGR_NM, oar.AGGR_DESC, replace(trim(ora.ATTR_NM), '{procUnitId}', oam.sys_proc_id) as ATTR_NM,  oare.AGGR_ELEM_TYP_ID,oare.AGGR_ORD FROM TMP_RRC_AGGR_MAP oam, TMP_RRC_AGGR_RULE oar, TMP_RRC_AGGR_RULE_ELEM oare,TMP_RRC_AGGR_RULE_ELEM_TYP oaret , TMP_RRC_ETL_ATTRIBUTE ora WHERE oam.AGGR_RULE_ID=oar.AGGR_RULE_ID AND oam.AGGR_RULE_ID  = oare.AGGR_RULE_ID AND oare.ATTR_ID = ora.ATTR_ID AND oare.AGGR_ELEM_TYP_ID = oaret.AGGR_ELEM_TYP_ID AND oam.eff_sts='A' ORDER BY oam.AGGR_RULE_ID,oare.AGGR_ELEM_TYP_ID, oare.AGGR_ORD

#query.cache.rules.aggregation.sql.with.key=select DECODE(OAM.cat_cd , null,'',OAM.cat_cd||':') || DECODE(OAM.sys_proc_id , null,'',OAM.sys_proc_id) AS key, TRIM(UPPER(OAM.sys_proc_id)) as PROC_UNIT_ID,OAM.AGGR_RULE_ID,OAR.AGGR_NM, OAR.AGGR_DESC,OAR.ISRT_SQL from tmp_rrc_AGGR_MAP OAM, tmp_rrc_AGGR_RULE OAR where OAM.AGGR_RULE_ID=OAR.AGGR_RULE_ID and OAM.EFF_STS='A' order by OAM.AGGR_RULE_ID

#query.cache.rules.aggregation.with.key=select DECODE(OAM.cat_cd , null,'',OAM.cat_cd||':') || DECODE(oam.sys_proc_id , null,'',OAM.sys_proc_id) AS  KEY,trim(oam.sys_proc_id) AS PROCESSING_UNIT_ID,oam.AGGR_RULE_ID,oar.AGGR_NM, oar.AGGR_DESC, replace(trim(ora.ATTR_NM), '{procUnitId}', oam.sys_proc_id) as ATTR_NM,  oare.AGGR_ELEM_TYP_ID,oare.AGGR_ORD FROM TMP_RRC_AGGR_MAP oam, TMP_RRC_AGGR_RULE oar, TMP_RRC_AGGR_RULE_ELEM oare,TMP_RRC_AGGR_RULE_ELEM_TYP oaret , TMP_RRC_ETL_ATTRIBUTE ora WHERE oam.AGGR_RULE_ID=oar.AGGR_RULE_ID AND oam.AGGR_RULE_ID  = oare.AGGR_RULE_ID AND oare.ATTR_ID = ora.ATTR_ID AND oare.AGGR_ELEM_TYP_ID = oaret.AGGR_ELEM_TYP_ID AND oam.eff_sts='A'  and OARE.EFF_STS='A' ORDER BY oam.AGGR_RULE_ID,oare.AGGR_ELEM_TYP_ID, oare.AGGR_ORD

#query.cache.rules.validation.spel.with.key=SELECT DECODE(map.cat_cd , NULL,'',map.cat_cd || ':') || DECODE(map.sys_proc_id , NULL,'',map.sys_proc_id) AS KEY, map.sys_proc_id AS sys_proc_id, mstr.vld_rule_id AS rule_id, attr.attr_id AS rule_attribute_id, attr.attr_desc AS rule_attribute, REPLACE(REPLACE(REPLACE(mstr.rrc_vld_rule_to_exec, '{scheduleIdHolder}', pu.proc_unit_id), '{busFuncHolder}', Trim(pu.bus_func_cd)),'{sysProcHolder}', Trim(spd.sys_proc_id))  AS rule_to_execute , mstr.vld_err_msg_txt AS err_msg, mstr.rpt_val_expr AS audit_values, map.vld_rule_exec_ord AS rule_order FROM TMP_RRC_vld_rule mstr, TMP_RRC_vld_map map, TMP_RRC_etl_attribute attr, TMP_RRC_sys_proc_def spd, rrr_proc_unit pu WHERE map.vld_rule_id= mstr.vld_rule_id AND map.attr_id=attr.attr_id AND map.sys_proc_id=spd.sys_proc_id AND spd.proc_unit_id=pu.proc_unit_id AND mstr.eff_sts='A' and map.eff_sts='A' ORDER BY rule_order

query.cache.referencedata.countryRegion=SELECT DISTINCT CNT_RGN.CNTRY_CD, RGN.RGN_NM FROM RRR_CNTRY_RGN_MAP CNT_RGN, RRR_REGION RGN WHERE RGN.RGN_ID=CNT_RGN.RGN_ID